AT_BANNER([Hierarchical resources use case checks])

AT_SETUP([Use case X6])
AT_DATA([expout],
[[ 1 locking for 4 seconds
 2 locking for 2 seconds
 3 locking for 2 seconds
 2 ending
 1 ending
 3 ending
]])
AT_CHECK([flom_test_exec3.sh 1 0 4 "-r /apple/pear/banana" & flom_test_exec3.sh 2 1 2 "-r /apple/watermelon" & flom_test_exec3.sh 3 2 2 "-r /apple/watermelon/bilberry" & flom_test_exec3.sh 4 4 0 "-r /apple" >/dev/null], [0], [expout], [ignore])
AT_CLEANUP

AT_SETUP([Use case X5])
AT_DATA([expout],
[[ 1 locking for 5 seconds
 2 locking for 3 seconds
 3 locking for 1 seconds
 3 ending
 2 ending
 1 ending
]])
AT_CHECK([flom_test_exec3.sh 1 0 5 "-l CR -r /apple/pear/banana" & flom_test_exec3.sh 2 1 3 "-l CR -r /apple/pear" & flom_test_exec3.sh 3 2 1 "-l PR -r /apple" & flom_test_exec3.sh 4 3 0 "-r /apple" >/dev/null], [0], [expout], [ignore])
AT_CLEANUP

AT_SETUP([Use case X4])
AT_DATA([expout],
[[ 1 locking for 5 seconds
 2 locking for 3 seconds
 3 locking for 1 seconds
 3 ending
 2 ending
 1 ending
]])
AT_CHECK([flom_test_exec3.sh 1 0 5 "-l CR -r /apple" & flom_test_exec3.sh 2 1 3 "-l PW -r /apple/pear/banana" & flom_test_exec3.sh 3 2 1 "-l CR -r /apple/pear" & flom_test_exec3.sh 4 3 0 "-r /apple" >/dev/null], [0], [expout], [ignore])
AT_CLEANUP

AT_SETUP([Use case X3])
AT_DATA([expout],
[[ 1 locking for 3 seconds
 2 locking for 1 seconds
 3 locking for 1 seconds
 1 ending
 2 ending
 3 ending
]])
AT_CHECK([flom_test_exec3.sh 1 0 3 "-r /apple/pear/banana" & flom_test_exec3.sh 2 1 1 "-r /apple/pear" & flom_test_exec3.sh 3 2 1 "-r /apple" & flom_test_exec3.sh 4 3 0 "-r /apple" >/dev/null], [0], [expout], [ignore])
AT_CLEANUP

AT_SETUP([Use case X2])
AT_DATA([expout],
[[ 1 locking for 3 seconds
 2 locking for 1 seconds
 3 locking for 1 seconds
 1 ending
 2 ending
 3 ending
]])
AT_CHECK([flom_test_exec3.sh 1 0 3 "-r /apple" & flom_test_exec3.sh 2 1 1 "-r /apple/pear" & flom_test_exec3.sh 3 2 1 "-r /apple/pear/banana" & flom_test_exec3.sh 4 3 0 "-r /apple" >/dev/null], [0], [expout], [ignore])
AT_CLEANUP

AT_SETUP([Use case X1])
AT_DATA([expout],
[[ 1 locking for 5 seconds
 2 locking for 3 seconds
 3 locking for 1 seconds
 3 ending
 2 ending
 1 ending
]])
AT_CHECK([flom_test_exec3.sh 1 0 5 "-r /apple" & flom_test_exec3.sh 2 1 3 "-r /pear" & flom_test_exec3.sh 3 2 1 "-r /banana" & flom_test_exec3.sh 4 1 0 "-r /apple" >/dev/null], [0], [expout], [ignore])
AT_CLEANUP

